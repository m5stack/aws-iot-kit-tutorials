<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Core2 for AWS IoT EduKit BSP: Real-Time Clock (RTC)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="AWS_logo_RGB.png"/></td>
  <td id="projectalign">
   <div id="projectname">Core2 for AWS IoT EduKit BSP<span id="projectnumber">&#160;2.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Real-Time Clock (RTC) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The RTC library provides convenience functions to interact with the BM8563 Real-Time Clock (RTC). The <a class="el" href="core2foraws__rtc_8h.html#ab6f98fa1f500a642a1349a272c98adc6">core2foraws_rtc_init</a> initialization function or <a class="el" href="core2foraws_8h.html#a8589c127068e67d5474515365b558051">core2foraws_init</a> wrapper function configures the Espressif ESP-IDF I2C driver with the thread-safe ropg <a href="https://github.com/ropg/i2c_manager">i2c_manager</a> to communicate with the RTC. The RTC is a high accuracy time-keeper with a built-in timer and alarm functionality. The RTC's time is backed up with the device's battery. If the battery is fully depleted while unplugged from power, the RTC will reset.</p>
<p ><a class="anchor" id="rtc_library"></a></p>
<p ><a href="./block_diagram-bm8563.png"><img src="./block_diagram-bm8563.png" alt="Circuit Block Diagram for BM8563 Real-Time Clock" class="center" class="inline"/></a></p>
<p >To enable the BSP hardware features, open the KConfig menu using the command <code>pio run --environment core2foraws --target menuconfig</code> from within the root of the project directory in your <a href="/en/blinky-hello-world/prerequisites.html#open-the-platformio-cli-terminal-window">PlatformIO terminal window</a> and go to the menu <code>Component Config --&gt; Core2 for AWS hardware features</code> to set the features you want to enable.</p>
<h1><a class="anchor" id="rtc_example"></a>
Example</h1>
<p >The following example initializes the Core2 for AWS, which initializes the PMU for the battery and the RTC. It then gets the current set date time from RTC, stringifies the time struct contents, and prints it to the ESP logger.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;time.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;esp_log.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="core2foraws_8h.html">core2foraws.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *TAG = <span class="stringliteral">&quot;RTC_EXAMPLE&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> app_main( <span class="keywordtype">void</span> )</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="core2foraws_8h.html#a8589c127068e67d5474515365b558051">core2foraws_init</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>tm rtc;</div>
<div class="line">    <span class="keywordtype">char</span> buffer[ 128 ];</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="core2foraws__rtc_8h.html#a6d2e19f044f103c0dea154b7006d8af6">core2foraws_rtc_time_get</a>( &amp;rtc );</div>
<div class="line">    </div>
<div class="line">    strftime( buffer, 128 ,<span class="stringliteral">&quot;%c (day %j)&quot;</span> , &amp;rtc );</div>
<div class="line">    ESP_LOGI( TAG, <span class="stringliteral">&quot;\tCurrent time: %s\n&quot;</span>, buffer );</div>
<div class="line">}</div>
<div class="ttc" id="acore2foraws_8h_html"><div class="ttname"><a href="core2foraws_8h.html">core2foraws.h</a></div><div class="ttdoc">Core2 for AWS IoT EduKit general hardware driver APIs.</div></div>
<div class="ttc" id="acore2foraws_8h_html_a8589c127068e67d5474515365b558051"><div class="ttname"><a href="core2foraws_8h.html#a8589c127068e67d5474515365b558051">core2foraws_init</a></div><div class="ttdeci">esp_err_t core2foraws_init(void)</div><div class="ttdoc">Initializes enabled hardware features.</div></div>
<div class="ttc" id="acore2foraws__rtc_8h_html_a6d2e19f044f103c0dea154b7006d8af6"><div class="ttname"><a href="core2foraws__rtc_8h.html#a6d2e19f044f103c0dea154b7006d8af6">core2foraws_rtc_time_get</a></div><div class="ttdeci">esp_err_t core2foraws_rtc_time_get(struct tm *time)</div><div class="ttdoc">Gets the date and time from the Real-Time Clock (RTC).</div></div>
</div><!-- fragment --><h1><a class="anchor" id="rtc_preprocessor_macros"></a>
Preprocessor Macros</h1>
<ul>
<li><a class="el" href="rtc_alarm_none_macro.html">RTC_ALARM_NONE</a> <br  />
</li>
<li><a class="el" href="rtc_alarm_disable.html">RTC_ALARM_DISABLE</a> <br  />
</li>
</ul>
<h1><a class="anchor" id="rtc_functions"></a>
Functions</h1>
<ul>
<li><a class="el" href="core2foraws_rtc_init_function.html">core2foraws_rtc_init</a> <br  />
</li>
<li><a class="el" href="core2foraws_rtc_time_get_function.html">core2foraws_rtc_time_get</a> <br  />
</li>
<li><a class="el" href="core2foraws_rtc_time_set_function.html">core2foraws_rtc_time_set</a> <br  />
</li>
<li><a class="el" href="core2foraws_rtc_alarm_get_function.html">core2foraws_rtc_alarm_get</a> <br  />
</li>
<li><a class="el" href="core2foraws_rtc_alarm_set_function.html">core2foraws_rtc_alarm_set</a> <br  />
</li>
<li><a class="el" href="core2foraws_rtc_alarm_triggered_function.html">core2foraws_rtc_alarm_triggered</a> <br  />
</li>
<li><a class="el" href="core2foraws_rtc_alarm_clear_function.html">core2foraws_rtc_alarm_clear</a> <br  />
</li>
<li><a class="el" href="core2foraws_rtc_timer_get_function.html">core2foraws_rtc_timer_get</a> <br  />
</li>
<li><a class="el" href="core2foraws_rtc_timer_set_function.html">core2foraws_rtc_timer_set</a> <br  />
</li>
<li><a class="el" href="core2foraws_rtc_timer_triggered_function.html">core2foraws_rtc_timer_triggered</a> <br  />
</li>
<li><a class="el" href="core2foraws_rtc_timer_clear_function.html">core2foraws_rtc_timer_clear</a> <br  />
 </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>

<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Core2 for AWS IoT Kit BSP: Button (virtual)</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8V9B1GPE56"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-8V9B1GPE56');
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="AWS_logo_RGB.png"/></td>
  <td id="projectalign">
   <div id="projectname">Core2 for AWS IoT Kit BSP<span id="projectnumber">&#160;2.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Button (virtual) </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The button library provides convenience functions to interact with the virtual buttons defined by specified areas on the front of the device. There are three virtual buttons aligned to the circles etched on the front of the M5Stack Core2 for AWS IoT Kit reference hardware.</p>
<p ><a class="anchor" id="button_lib"></a></p>
<p >This library uses the FreeRTOS queue <code>ft6x36_touch_queue_handle</code> that is available in the <a href="https://github.com/lvgl/lvgl_esp32_drivers/blob/master/lvgl_touch/ft6x36.h#L160">lvgl_esp32_drivers</a> . and thus requires that the display be enabled and initialized in order to work. The library receives touch coordinates from the touch driver to provide user polled functions that provides the state of a button. The library needs to be initialized with <a class="el" href="core2foraws__button_8h.html#afaab009664ab27dd0d69ccac31804049">core2foraws_button_init</a> or the <a class="el" href="core2foraws_8h.html#a8589c127068e67d5474515365b558051">core2foraws_init</a> wrapper function.</p>
<p >To enable the BSP hardware features, open the KConfig menu using the command <code>pio run --environment core2foraws --target menuconfig</code> from within the root of the project directory in your <a href="/en/blinky-hello-world/prerequisites.html#open-the-platformio-cli-terminal-window">PlatformIO terminal window</a> and go to the menu <code>Component Config --&gt; Core2 for AWS hardware features</code> to set the features you want to enable.</p>
<h1><a class="anchor" id="button_example"></a>
Example</h1>
<p >The following example initializes the Core2 for AWS, which initializes a number of enabled features, including the power management unit, display driver, touch driver, and the virtual button driver. It then creates a FreeRTOS task of priority 0 that polls the buttons for different press interactions and prints the events to serial output. The left button is detecting taps (pressed and let go) or being held past the set long press time, the middle button checks if it is actively being pressed at the moment, the right button checks whether it was tapped and when it was let go.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;freertos/FreeRTOS.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;freertos/task.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;esp_log.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *TAG = <span class="stringliteral">&quot;MAIN_BUTTON_DEMO&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> button_task( <span class="keywordtype">void</span> *pvParams )</div>
<div class="line">{</div>
<div class="line">    ESP_LOGI( TAG, <span class="stringliteral">&quot;\tStarting button test&quot;</span> );</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">while</span> ( <span class="keyword">true</span> )</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">bool</span> button_event = <span class="keyword">false</span>;</div>
<div class="line">        <a class="code hl_function" href="core2foraws__button_8h.html#afb4e5b5ecd9d001560bda9e1c29e3976">core2foraws_button_tapped</a>( <a class="code hl_enumvalue" href="core2foraws__button_8h.html#a8702c2667db046d90adea013eb085a4aa55dc0d53615e28ee8af66827bee48e4e">BUTTON_LEFT</a>, &amp;button_event );</div>
<div class="line">        <span class="keywordflow">if</span> ( button_event )</div>
<div class="line">            ESP_LOGI( TAG, <span class="stringliteral">&quot;Left button was tapped&quot;</span> );</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_function" href="core2foraws__button_8h.html#a4893df4cc5d6e194c274c332d1a36edf">core2foraws_button_held</a>( <a class="code hl_enumvalue" href="core2foraws__button_8h.html#a8702c2667db046d90adea013eb085a4aa55dc0d53615e28ee8af66827bee48e4e">BUTTON_LEFT</a>, &amp;button_event );</div>
<div class="line">        <span class="keywordflow">if</span> ( button_event )</div>
<div class="line">            ESP_LOGI( TAG, <span class="stringliteral">&quot;Left button was held for more than %dms&quot;</span>, LV_INDEV_DEF_LONG_PRESS_TIME );</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_function" href="core2foraws__button_8h.html#a8d69f1cf3d5c167836ef2e16f0e35a41">core2foraws_button_pressing</a>( <a class="code hl_enumvalue" href="core2foraws__button_8h.html#a8702c2667db046d90adea013eb085a4aadc5b6dc06792e0f36a19c74e9c77c6fb">BUTTON_MIDDLE</a>, &amp;button_event );</div>
<div class="line">        <span class="keywordflow">if</span> ( button_event )</div>
<div class="line">            ESP_LOGI( TAG, <span class="stringliteral">&quot;Middle button is currently being pressed&quot;</span> );</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_function" href="core2foraws__button_8h.html#afb4e5b5ecd9d001560bda9e1c29e3976">core2foraws_button_tapped</a>( <a class="code hl_enumvalue" href="core2foraws__button_8h.html#a8702c2667db046d90adea013eb085a4aa13046edd6d64a0de5821b5ff4c7581ce">BUTTON_RIGHT</a>, &amp;button_event );</div>
<div class="line">        <span class="keywordflow">if</span> ( button_event )</div>
<div class="line">            ESP_LOGI( TAG, <span class="stringliteral">&quot;Right button was tapped&quot;</span> );</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_function" href="core2foraws__button_8h.html#a6aa0de4f4e4c917a753b1ec68bd4391c">core2foraws_button_released</a>( <a class="code hl_enumvalue" href="core2foraws__button_8h.html#a8702c2667db046d90adea013eb085a4aa13046edd6d64a0de5821b5ff4c7581ce">BUTTON_RIGHT</a>, &amp;button_event );</div>
<div class="line">        <span class="keywordflow">if</span> ( button_event )</div>
<div class="line">            ESP_LOGI( TAG, <span class="stringliteral">&quot;Right button was released&quot;</span> );</div>
<div class="line"> </div>
<div class="line">        vTaskDelay( pdMS_TO_TICKS( 40 ) );</div>
<div class="line">    }</div>
<div class="line">    vTaskDelete( NULL );</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> app_main(<span class="keywordtype">void</span>)</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="core2foraws_8h.html#a8589c127068e67d5474515365b558051">core2foraws_init</a>();</div>
<div class="line"> </div>
<div class="line">    xTaskCreatePinnedToCore(    &amp;button_task,               <span class="comment">// Pointer to the task entry function</span></div>
<div class="line">                                <span class="stringliteral">&quot;buttonTest&quot;</span>,               <span class="comment">// Friendly name of the task</span></div>
<div class="line">                                1024 * 2,                   <span class="comment">// Size of the task stack specified in bytes</span></div>
<div class="line">                                NULL,                       <span class="comment">// Pointer to parameters passed to task</span></div>
<div class="line">                                0,                          <span class="comment">// Priority the task will run (0 is lowest)</span></div>
<div class="line">                                ( TaskHandle_t * ) NULL,    <span class="comment">// Handle that the created task can be referenced</span></div>
<div class="line">                                1                           <span class="comment">// The CPU core to exexute the task</span></div>
<div class="line">                            );</div>
<div class="line">}</div>
<div class="ttc" id="acore2foraws_8h_html_a8589c127068e67d5474515365b558051"><div class="ttname"><a href="core2foraws_8h.html#a8589c127068e67d5474515365b558051">core2foraws_init</a></div><div class="ttdeci">esp_err_t core2foraws_init(void)</div><div class="ttdoc">Initializes enabled hardware features.</div></div>
<div class="ttc" id="acore2foraws__button_8h_html_a4893df4cc5d6e194c274c332d1a36edf"><div class="ttname"><a href="core2foraws__button_8h.html#a4893df4cc5d6e194c274c332d1a36edf">core2foraws_button_held</a></div><div class="ttdeci">esp_err_t core2foraws_button_held(enum core2foraws_button_btns button, bool *state)</div><div class="ttdoc">See if the specified button was held.</div></div>
<div class="ttc" id="acore2foraws__button_8h_html_a6aa0de4f4e4c917a753b1ec68bd4391c"><div class="ttname"><a href="core2foraws__button_8h.html#a6aa0de4f4e4c917a753b1ec68bd4391c">core2foraws_button_released</a></div><div class="ttdeci">esp_err_t core2foraws_button_released(enum core2foraws_button_btns button, bool *state)</div><div class="ttdoc">See if the specified button was pressed button has been released.</div></div>
<div class="ttc" id="acore2foraws__button_8h_html_a8702c2667db046d90adea013eb085a4aa13046edd6d64a0de5821b5ff4c7581ce"><div class="ttname"><a href="core2foraws__button_8h.html#a8702c2667db046d90adea013eb085a4aa13046edd6d64a0de5821b5ff4c7581ce">BUTTON_RIGHT</a></div><div class="ttdeci">@ BUTTON_RIGHT</div><div class="ttdef"><b>Definition:</b> core2foraws_button.h:78</div></div>
<div class="ttc" id="acore2foraws__button_8h_html_a8702c2667db046d90adea013eb085a4aa55dc0d53615e28ee8af66827bee48e4e"><div class="ttname"><a href="core2foraws__button_8h.html#a8702c2667db046d90adea013eb085a4aa55dc0d53615e28ee8af66827bee48e4e">BUTTON_LEFT</a></div><div class="ttdeci">@ BUTTON_LEFT</div><div class="ttdef"><b>Definition:</b> core2foraws_button.h:76</div></div>
<div class="ttc" id="acore2foraws__button_8h_html_a8702c2667db046d90adea013eb085a4aadc5b6dc06792e0f36a19c74e9c77c6fb"><div class="ttname"><a href="core2foraws__button_8h.html#a8702c2667db046d90adea013eb085a4aadc5b6dc06792e0f36a19c74e9c77c6fb">BUTTON_MIDDLE</a></div><div class="ttdeci">@ BUTTON_MIDDLE</div><div class="ttdef"><b>Definition:</b> core2foraws_button.h:77</div></div>
<div class="ttc" id="acore2foraws__button_8h_html_a8d69f1cf3d5c167836ef2e16f0e35a41"><div class="ttname"><a href="core2foraws__button_8h.html#a8d69f1cf3d5c167836ef2e16f0e35a41">core2foraws_button_pressing</a></div><div class="ttdeci">esp_err_t core2foraws_button_pressing(enum core2foraws_button_btns button, bool *state)</div><div class="ttdoc">See if the specified button was tapped.</div></div>
<div class="ttc" id="acore2foraws__button_8h_html_afb4e5b5ecd9d001560bda9e1c29e3976"><div class="ttname"><a href="core2foraws__button_8h.html#afb4e5b5ecd9d001560bda9e1c29e3976">core2foraws_button_tapped</a></div><div class="ttdeci">esp_err_t core2foraws_button_tapped(enum core2foraws_button_btns button, bool *state)</div><div class="ttdoc">See if the specified button was tapped.</div></div>
</div><!-- fragment --><h1><a class="anchor" id="button_enumerated_lists"></a>
Enumerated Lists</h1>
<ul>
<li><a class="el" href="core2foraws_button_btns_enum.html">core2foraws_button_btns</a> <br  />
</li>
</ul>
<h1><a class="anchor" id="button_type_definitions"></a>
Type Definitions</h1>
<ul>
<li><a class="el" href="press_event_t_enum.html">press_event_t</a> <br  />
</li>
</ul>
<h1><a class="anchor" id="button_functions"></a>
Functions</h1>
<ul>
<li><a class="el" href="core2foraws_button_init_function.html">core2foraws_button_init</a> <br  />
</li>
<li><a class="el" href="core2foraws_button_tapped_function.html">core2foraws_button_tapped</a> <br  />
</li>
<li><a class="el" href="core2foraws_button_pressing_function.html">core2foraws_button_pressing</a> <br  />
</li>
<li><a class="el" href="core2foraws_button_held_function.html">core2foraws_button_held</a> <br  />
</li>
<li><a class="el" href="core2foraws_button_released_function.html">core2foraws_button_released</a> <br  />
 </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>

<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Core2 for AWS IoT Kit BSP: External Grove Connector Expansion Ports</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8V9B1GPE56"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-8V9B1GPE56');
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="AWS_logo_RGB.png"/></td>
  <td id="projectalign">
   <div id="projectname">Core2 for AWS IoT Kit BSP<span id="projectnumber">&#160;2.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">External Grove Connector Expansion Ports </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The APIs for the side expansion ports wrap Espressif's peripheral APIs to simplify configuration and usage of GPIO, I2C, ADC, DAC, and UART. All GPIOs support digital read, all external port pins support digital writes except GPIO.</p>
<p ><a class="anchor" id="expports_intro"></a></p><ol type="1">
<li>The APIs provided are only for convenience and may not be sufficient for all peripherals that are plugged in. For accessing native functionality of the GPIO pins on the expansion ports, visit Espressif's <a href="https://docs.espressif.com/projects/esp-idf/en/release-v4.2/esp32/api-reference/peripherals/index.html">official documentation</a> and view their <a href="https://github.com/espressif/esp-idf/tree/1cb31e50943bb757966ca91ed7f4852692a5b0ed/examples/peripherals">examples on GitHub</a>. Please note that using Espressif's examples would require changing the pin configurations to match the available pins listed in the table below.</li>
</ol>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Port   </th><th class="markdownTableHeadNone">Pin   </th><th class="markdownTableHeadNone">Feature   </th><th class="markdownTableHeadNone">Helpful Macro Definition(s) to Access Pin    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">32   </td><td class="markdownTableBodyNone">I2C SDA   </td><td class="markdownTableBodyNone"><a class="el" href="core2foraws__expports_8h.html#ae784eb494430f328a674932e03ee1b26">PORT_A_SDA_PIN</a> or GPIO_NUM_32    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">A   </td><td class="markdownTableBodyNone">33   </td><td class="markdownTableBodyNone">I2C SCL   </td><td class="markdownTableBodyNone"><a class="el" href="core2foraws__expports_8h.html#a8ed50e23fc6f3e2e2e5d3f58fd1e3d05">PORT_A_SCL_PIN</a> or GPIO_NUM_33    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">B   </td><td class="markdownTableBodyNone">26   </td><td class="markdownTableBodyNone">DAC   </td><td class="markdownTableBodyNone"><a class="el" href="core2foraws__expports_8h.html#ac708091286fa469920c756366ca4e683">PORT_B_DAC_PIN</a> or GPIO_NUM_26    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">B   </td><td class="markdownTableBodyNone">36   </td><td class="markdownTableBodyNone">ADC   </td><td class="markdownTableBodyNone"><a class="el" href="core2foraws__expports_8h.html#acc191b4d5b52786c63d4692d6cb80d40">PORT_B_ADC_PIN</a> or GPIO_NUM_36    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">C   </td><td class="markdownTableBodyNone">13   </td><td class="markdownTableBodyNone">UART RX   </td><td class="markdownTableBodyNone"><a class="el" href="core2foraws__expports_8h.html#a1d7f3c77703d9c2c8654700f05f04f81">PORT_C_UART_RX_PIN</a> or GPIO_NUM_13    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">C   </td><td class="markdownTableBodyNone">14   </td><td class="markdownTableBodyNone">UART TX   </td><td class="markdownTableBodyNone"><a class="el" href="core2foraws__expports_8h.html#a8764a8d2c486f2d66f86d995653cc833">PORT_C_UART_TX_PIN</a> or GPIO_NUM_14   </td></tr>
</table>
<p ><a href="./block_diagram-expports.png"><img src="./block_diagram-expports.png" alt="Circuit Block Diagram for the external Grove connector expansion ports" class="center" class="inline"/></a></p>
<p >To enable the BSP hardware features, open the KConfig menu using the command <code>pio run --environment core2foraws --target menuconfig</code> from within the root of the project directory in your <a href="/en/blinky-hello-world/prerequisites.html#open-the-platformio-cli-terminal-window">PlatformIO terminal window</a> and go to the menu <code>Component Config --&gt; Core2 for AWS hardware features</code> to set the features you want to enable.</p>
<h1><a class="anchor" id="expports_example"></a>
Example</h1>
<p >The example code sets GPIO 26 (same as <a class="el" href="core2foraws__expports_8h.html#ac708091286fa469920c756366ca4e683">PORT_B_DAC_PIN</a>) as an input, creates a FreeRTOS task which periodically (1s) reads from GPIO 26 to see if a peripheral, which outputs high when powered, is connected. The task prints the returned value to the serial monitor. In the odd event the function exists the infinite for loop, the pin is reset and the task is deleted.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;freertos/FreeRTOS.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;freertos/semphr.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;esp_log.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="core2foraws_8h.html">core2foraws.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *TAG = <span class="stringliteral">&quot;EXP_PORT_EXAMPLE&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> read_port_ask( <span class="keywordtype">void</span> )</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">while</span>( <span class="keyword">true</span> )</div>
<div class="line">    {</div>
<div class="line">        ESP_LOGI(TAG, <span class="stringliteral">&quot;Sensor plugged in ( 0=no / 1=yes ): %d&quot;</span>, <a class="code hl_function" href="core2foraws__expports_8h.html#a2ff29b8accafd1c26fc47af4645a15de">core2foraws_expports_digital_read</a>( <a class="code hl_define" href="core2foraws__expports_8h.html#ac708091286fa469920c756366ca4e683">PORT_B_DAC_PIN</a> ) );</div>
<div class="line">        vTaskDelay( pdMS_TO_TICKS( 1000 ) );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_function" href="core2foraws__expports_8h.html#a54ab7b5c4ff54b17a2f4e48207a2b1b5">core2foraws_expports_pin_reset</a>( <a class="code hl_define" href="core2foraws__expports_8h.html#ac708091286fa469920c756366ca4e683">PORT_B_DAC_PIN</a> );</div>
<div class="line">    vTaskDelete( NULL );</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> app_main( <span class="keywordtype">void</span> )</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="core2foraws_8h.html#a8589c127068e67d5474515365b558051">core2foraws_init</a>();</div>
<div class="line">    <span class="keywordflow">if</span>(err == ESP_OK){</div>
<div class="line">        xTaskCreatePinnedToCore(    </div>
<div class="line">                                    &amp;read_port_ask,                 <span class="comment">// Pointer to the task entry function</span></div>
<div class="line">                                    <span class="stringliteral">&quot;read_pin&quot;</span>,                     <span class="comment">// Friendly name of the task</span></div>
<div class="line">                                    configMINIMAL_STACK_SIZE * 3,   <span class="comment">// Size of the task stack specified in bytes</span></div>
<div class="line">                                    NULL,                           <span class="comment">// Pointer to parameters passed to task</span></div>
<div class="line">                                    1,                              <span class="comment">// Priority the task will run (0 is lowest)</span></div>
<div class="line">                                    ( TaskHandle_t * ) NULL,        <span class="comment">// Handle that the created task can be referenced</span></div>
<div class="line">                                    1                               <span class="comment">// The CPU core to exexute the task</span></div>
<div class="line">                                );                            </div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="acore2foraws_8h_html"><div class="ttname"><a href="core2foraws_8h.html">core2foraws.h</a></div><div class="ttdoc">Core2 for AWS IoT Kit general hardware driver APIs.</div></div>
<div class="ttc" id="acore2foraws_8h_html_a8589c127068e67d5474515365b558051"><div class="ttname"><a href="core2foraws_8h.html#a8589c127068e67d5474515365b558051">core2foraws_init</a></div><div class="ttdeci">esp_err_t core2foraws_init(void)</div><div class="ttdoc">Initializes enabled hardware features.</div></div>
<div class="ttc" id="acore2foraws__expports_8h_html_a2ff29b8accafd1c26fc47af4645a15de"><div class="ttname"><a href="core2foraws__expports_8h.html#a2ff29b8accafd1c26fc47af4645a15de">core2foraws_expports_digital_read</a></div><div class="ttdeci">esp_err_t core2foraws_expports_digital_read(gpio_num_t pin, bool *level)</div><div class="ttdoc">Reads the value from a specified digital pin — either 1 (high) or 0 (low).</div></div>
<div class="ttc" id="acore2foraws__expports_8h_html_a54ab7b5c4ff54b17a2f4e48207a2b1b5"><div class="ttname"><a href="core2foraws__expports_8h.html#a54ab7b5c4ff54b17a2f4e48207a2b1b5">core2foraws_expports_pin_reset</a></div><div class="ttdeci">esp_err_t core2foraws_expports_pin_reset(gpio_num_t pin)</div><div class="ttdoc">Resets the specified pin.</div></div>
<div class="ttc" id="acore2foraws__expports_8h_html_ac708091286fa469920c756366ca4e683"><div class="ttname"><a href="core2foraws__expports_8h.html#ac708091286fa469920c756366ca4e683">PORT_B_DAC_PIN</a></div><div class="ttdeci">#define PORT_B_DAC_PIN</div><div class="ttdoc">The DAC pin on expansion port B.</div><div class="ttdef"><b>Definition:</b> core2foraws_expports.h:96</div></div>
</div><!-- fragment --><h1><a class="anchor" id="expports_preprocessor_macros"></a>
Preprocessor Macros</h1>
<ul>
<li><a class="el" href="port_a_sda_pin_macro.html">PORT_A_SDA_PIN</a> <br  />
</li>
<li><a class="el" href="port_a_scl_pin_macro.html">PORT_A_SCL_PIN</a> <br  />
</li>
<li><a class="el" href="i2c_no_register_macro.html">I2C_NO_REGISTER_ADDR</a> <br  />
</li>
<li><a class="el" href="port_b_adc_pin_macro.html">PORT_B_ADC_PIN</a> <br  />
</li>
<li><a class="el" href="port_b_dac_pin_macro.html">PORT_B_DAC_PIN</a> <br  />
</li>
<li><a class="el" href="port_c_uart_rx_pin_macro.html">PORT_C_UART_RX_PIN</a> <br  />
</li>
<li><a class="el" href="port_c_uart_tx_pin_macro.html">PORT_C_UART_TX_PIN</a> <br  />
</li>
<li><a class="el" href="port_c_uart_num_macro.html">PORT_C_UART_NUM</a> <br  />
</li>
<li><a class="el" href="uart_rx_buf_size_macro.html">UART_RX_BUF_SIZE</a> <br  />
</li>
</ul>
<h1><a class="anchor" id="expports_functions"></a>
Functions</h1>
<ul>
<li><a class="el" href="core2foraws_expports_digital_read_function.html">core2foraws_expports_digital_read</a> <br  />
</li>
<li><a class="el" href="core2foraws_expports_digital_write_function.html">core2foraws_expports_digital_write</a> <br  />
</li>
<li><a class="el" href="core2foraws_expports_pin_reset_function.html">core2foraws_expports_pin_reset</a> <br  />
</li>
<li><a class="el" href="core2foraws_expports_i2c_begin_function.html">core2foraws_expports_i2c_begin</a> <br  />
</li>
<li><a class="el" href="core2foraws_expports_i2c_read_function.html">core2foraws_expports_i2c_read</a> <br  />
</li>
<li><a class="el" href="core2foraws_expports_i2c_write_function.html">core2foraws_expports_i2c_write</a> <br  />
</li>
<li><a class="el" href="core2foraws_expports_i2c_close_function.html">core2foraws_expports_i2c_close</a> <br  />
</li>
<li><a class="el" href="core2foraws_expports_adc_read_function.html">core2foraws_expports_adc_read</a> <br  />
</li>
<li><a class="el" href="core2foraws_expports_dac_mv_write_function.html">core2foraws_expports_dac_mv_write</a> <br  />
</li>
<li><a class="el" href="core2foraws_expports_uart_begin_function.html">core2foraws_expports_uart_begin</a> <br  />
</li>
<li><a class="el" href="core2foraws_expports_uart_write_function.html">core2foraws_expports_uart_write</a> <br  />
</li>
<li><a class="el" href="core2foraws_expports_uart_read_function.html">core2foraws_expports_uart_read</a> <br  />
 </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>

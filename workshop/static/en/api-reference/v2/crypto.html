<!-- HTML header for doxygen 1.9.3-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.3"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Core2 for AWS IoT EduKit BSP: CRYPTO</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8V9B1GPE56"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-8V9B1GPE56');
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="AWS_logo_RGB.png"/></td>
  <td id="projectalign">
   <div id="projectname">Core2 for AWS IoT EduKit BSP<span id="projectnumber">&#160;2.0.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.3 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">CRYPTO </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >The crypto library provides convenience functions to interact with the Microchip ATECC608 Trust&amp;GO secure element. The initialization function configures the Microchip <a href="https://www.microchip.com/en-us/products/security-ics/trust-platform">CryptoAuthLib</a> driver for the secure element with preset parameters using the ESP-IDF I2C driver and the thread-safe ropg <a href="https://github.com/ropg/i2c_manager">i2c_manager</a> . The <a href="https://github.com/espressif/esp-cryptoauthlib">esp-cryptoauthlib</a> is a customized port of the Microchip CryptoAuthLib library to work with the Core2 for AWS IoT EduKit. The application can use the CryptoAuthLib APIs to access the secure element as documented in <a href="https://microchiptech.github.io/cryptoauthlib/">their docs</a>. The pre-provisioned secure element provides a safe way to store and use keys without accidentally exposing the keys and compromising the device and resources the device has access to. The secure element provides access to signing and verifying of Elliptic Curve Digital Signature Algorithm (ECDSA) certificates using the private keys in the chip's storage slots.</p>
<p ><a class="anchor" id="crypto_lib"></a></p>
<p ><a href="./block_diagram-atecc608.png"><img src="./block_diagram-atecc608.png" alt="Circuit Block Diagram for the ATECC608 Secure Element" class="center" class="inline"/></a></p>
<p >To enable the BSP hardware features, open the KConfig menu using the command <code>pio run --environment core2foraws --target menuconfig</code> from within the root of the project directory in your <a href="/en/blinky-hello-world/prerequisites.html#open-the-platformio-cli-terminal-window">PlatformIO terminal window</a> and go to the menu <code>Component Config --&gt; Core2 for AWS hardware features</code> to set the features you want to enable.</p>
<h1><a class="anchor" id="crypto_example"></a>
Example</h1>
<p >The following example initializes the Core2 for AWS, which initializes a number of enabled features, including the power management unit and ATECC608 cryptographic secure element. It then prints the ATECC608 serial number using the ESP logger.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;esp_log.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="core2foraws_8h.html">core2foraws.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *TAG = <span class="stringliteral">&quot;CRYPTO_EXAMPLE&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> app_main( <span class="keywordtype">void</span> )</div>
<div class="line">{</div>
<div class="line">    <a class="code hl_function" href="core2foraws_8h.html#a8589c127068e67d5474515365b558051">core2foraws_init</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">char</span> *serial_num = heap_caps_malloc( <a class="code hl_define" href="core2foraws__crypto_8h.html#a081a0e90d62bf5b7e16633053ced8522">CRYPTO_SERIAL_STR_SIZE</a>, MALLOC_CAP_SPIRAM );</div>
<div class="line">    ret = <a class="code hl_function" href="core2foraws__crypto_8h.html#ae3265b9c75bacf3b14e137cc1057ae3b">core2foraws_crypto_serial_get</a>( serial_num );</div>
<div class="line">    <span class="keywordflow">if</span> ( ret == ESP_OK )</div>
<div class="line">    {</div>
<div class="line">        ESP_LOGI(TAG, <span class="stringliteral">&quot;Serial number: %s&quot;</span>, serial_num);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="acore2foraws_8h_html"><div class="ttname"><a href="core2foraws_8h.html">core2foraws.h</a></div><div class="ttdoc">Core2 for AWS IoT EduKit general hardware driver APIs.</div></div>
<div class="ttc" id="acore2foraws_8h_html_a8589c127068e67d5474515365b558051"><div class="ttname"><a href="core2foraws_8h.html#a8589c127068e67d5474515365b558051">core2foraws_init</a></div><div class="ttdeci">esp_err_t core2foraws_init(void)</div><div class="ttdoc">Initializes enabled hardware features.</div></div>
<div class="ttc" id="acore2foraws__crypto_8h_html_a081a0e90d62bf5b7e16633053ced8522"><div class="ttname"><a href="core2foraws__crypto_8h.html#a081a0e90d62bf5b7e16633053ced8522">CRYPTO_SERIAL_STR_SIZE</a></div><div class="ttdeci">#define CRYPTO_SERIAL_STR_SIZE</div><div class="ttdoc">The size of the serial number as a string.</div><div class="ttdef"><b>Definition:</b> core2foraws_crypto.h:63</div></div>
<div class="ttc" id="acore2foraws__crypto_8h_html_ae3265b9c75bacf3b14e137cc1057ae3b"><div class="ttname"><a href="core2foraws__crypto_8h.html#ae3265b9c75bacf3b14e137cc1057ae3b">core2foraws_crypto_serial_get</a></div><div class="ttdeci">esp_err_t core2foraws_crypto_serial_get(char *serial_number)</div><div class="ttdoc">Retrieves the unique serial number from the ATECC608 as a string.</div></div>
</div><!-- fragment --><h1><a class="anchor" id="crypto_preprocessor_macros"></a>
Preprocessor Macros</h1>
<ul>
<li><a class="el" href="crypto_pub_key_size_macro.html">CRYPTO_PUB_KEY_SIZE</a> <br  />
</li>
<li><a class="el" href="core2foraws_crypto_max_signature_size_macro.html">CRYPTO_MAX_SIGNATURE_SIZE</a> <br  />
</li>
<li><a class="el" href="core2foraws_crypto_strial_str_size_macro.html">CRYPTO_SERIAL_STR_SIZE</a> <br  />
</li>
</ul>
<h1><a class="anchor" id="crypto_functions"></a>
Functions</h1>
<ul>
<li><a class="el" href="core2foraws_crypto_init_function.html">core2foraws_crypto_init</a> <br  />
</li>
<li><a class="el" href="core2foraws_crypto_pubkey_base64_get_function.html">core2foraws_crypto_pubkey_base64_get</a> <br  />
</li>
<li><a class="el" href="core2foraws_crypto_sha256_sign_function.html">core2foraws_crypto_sha256_sign</a> <br  />
</li>
<li><a class="el" href="core2foraws_crypto_serial_get_function.html">core2foraws_crypto_serial_get</a> <br  />
 </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.3
</small></address>
</body>
</html>

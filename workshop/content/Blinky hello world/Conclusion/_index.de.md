+++
title = "Fazit"
weight = 50
pre = "<b>e. </b>"
+++

Hoffentlich hat Ihnen der Aufbau Ihres mit der Cloud verbundenen Blinky-Projekts gefallen. Mit PlatformIO konnten Sie Ihren Core2 mit der Firmware von AWS IoT Kit konfigurieren, erstellen, flashen und überwachen. Ihr Gerät ist jetzt in Ihrem AWS-Konto als AWS IoT-Objekt registriert, um sichere Cloud-Konnektivität mithilfe integrierter sicherer Hardware zu gewährleisten. Sie haben eine Verbindung zu AWS IoT Core hergestellt, Nachrichten vom Gerät über MQTT gesendet und eine MQTT-Nachricht vom MQTT-Client der AWS IoT-Konsole erhalten, mit der die Lichter auf dem Gerät gesteuert wurden.

Während das AWS IoT Kit-Programm die Programmiersprache C nicht lehrt oder benötigt, ist es für die Embedded-Entwicklung von entscheidender Bedeutung. Die Steuerung und Flexibilität durch den Code ermöglicht es Ihnen, das maximale Potenzial Ihrer Hardware zu nutzen. Wenn Sie mit der C-Programmierung nicht vertraut sind, aber neugierig darauf sind, etwas zu lernen, oder eingerostete C-Kenntnisse auffrischen wollen, stellt Jens Gustedt [Modern C](https://gustedt.gitlabpages.inria.fr/modern-c/) unter der Creative Commons license zur Verfügung und sie können es [dort](https://gustedt.gitlabpages.inria.fr/modern-c/#orge4fc44a) kostenlos herunterladen.

## Was passiert auf dem Gerät
## Der FreeRTOS-Kernel
Die Anwendung auf dem Gerät läuft mit dem [FreeRTOS-Kernel](https://www.freertos.org/)— ein [Echtzeitbetriebssystem](https://www.freertos.org/about-RTOS.html) (RTOS). Es wird in der von Ihnen kompilierten Binärdatei (sowie anderen Bibliotheken und Treibern) mit Ihrem Anwendungscode gebündelt. Der FreeRTOS-Kernel plant einen Block sequenziellen Codes als [Task](https://www.freertos.org/taskandcr.html), um ihm einen Anteil an der Prozessorlaufzeit zu geben. Es gibt Tasks, die normalerweise dauerhaft laufen werden, um an AWS zu sendende Nachrichten zu erstellen, empfangene Nachrichten zu verarbeiten, das Display zu aktualisieren, die LEDs zu blinken usw.

Der Core2 für AWS IoT Kit verfügt über einen 240-MHz-Dual-Core-Prozessor, der jedoch im Vergleich zum heute üblichen 8+-Kern bei 4+GHz-Computern verblasst. Um das Beste aus der kostbaren Prozessorzeit herauszuholen, setzt der FreeRTOS-Kernel [Aufgaben in einen Status](https://www.freertos.org/RTOS-task-states.html) wie "Running" oder "Suspended". Der FreeRTOS-Kernel gibt Mikrocontroller-Anwendungen die Möglichkeit, den Prozessor zu optimieren, indem sie schnell zwischen einzelnen Aufgaben wechseln. Eine Aufgabe kann ausgeführt werden, sobald sich eine andere Aufgabe in einen angehaltenen oder blockierten Zustand versetzt hat (siehe Abbildung unten). Dies ergibt den Anschein von Parallelität und verbessert die Leistung einer eingebetteten Anwendung im Vergleich zu einer einfacheren [Superloop-Anwendung](https://en.wikibooks.org/wiki/Embedded_Systems/Super_Loop_Architecture) erheblich.
{{< img "RTOS_scheduling_execution.en.png" "Example of FreeRTOS application scheduling" "1 - MQTT startet, 2 - MQTT blockiert (keine neue Nachricht) & Display startet, 3 - MQTT läuft, verarbeitet Nachrichten & blockiert das Display, 4 - MQTT ist blockiert & Blink-Task läuft (LED an), 5 - Blink-Task blockiert & display läuft, 6 - Display blockiert & Blink-Task läuft (LED aus), 7 - Blink-Task blockiert & Display läuft">}}

Während Superloop-Anwendungen einfacher zu programmieren sind, führen Codesegmente, die die Ausführung von anderem Code blockieren/verzögern, dazu, dass die MCU im Leerlauf steht. Ein Gerät, das mit der AWS-Cloud verbunden ist, hat eine variable Round-Trip-Latenz und Bandbreitenbeschränkungen, die den Leistungsvorteil der Verwendung eines RTOS erforderlich machen. Ein RTOS bietet erhebliche Vorteile für andere Anwendungen, bei denen es wichtig ist, keine Daten zu verlieren oder einen kritischen Vorgang ausführen zu können, ohne durch die Ausführung eines anderen Codeblocks behindert zu werden (z. B. Gesundheit und Sicherheit), oder um einfach eine simples reaktives Display zu betreiben.
{{< img "super_loop_execution.en.png" "Example of super loop application execution" "1 - MQTT Nachricht unterbricht den aktuellen Zustand, 2 - MQTT Nachrichtenverarbeitung beginnt & LED geht an, Code Verarbeitung pausiert für 500 ms und die LED geht wieder aus, weitere 500ms Pause, 3 - Blink-Frequenz ist beendet & Display wird refreshed, 4 - Display-Task ist beendet, LED geht an, 500 ms Pause, LED geht aus, 500ms Pause" >}}

Um mehr über RTOS und FreeRTOS zu erfahren, schauen Sie sich [diese Videoserie](https://www.youtube.com/watch?v=F321087yYy4) an und besuchen Sie [Freertos.org](https://www.freertos.org/RTOS.html).

## AWS IoT-Geräte-SDK für Embedded C
Das in diesem Beispiel verwendete [AWS IoT Device SDK für Embedded C](https://github.com/espressif/aws-iot-device-sdk-embedded-C/tree/61f25f34712b1513bf1cb94771620e9b2b001970) hat die Konnektivität und den Nachrichtenaustausch mit AWS IoT erleichtert und konnte mit der mitgelieferten Bibliothek für sichere Elemente arbeiten, um Authentifizierung des zu erstellenden Objekts zu vereinfachen. Das Device SDK für Embedded C befindet sich im Ordner `Core2-for-aws-iot-edukit/blink-hello-world/Components/ESP-AWS-IOT /`.

## Das Board Support Package — Gerätetreiber
Die Hardwarefunktionen des Geräts wie Bildschirm, Energieverwaltungschip, sicheres Element, Lautsprecher, Mikrofon, 6-Achsen [Trägheitsmesseinheit](https://en.wikipedia.org/wiki/Inertial_measurement_unit) (IMU), Touch-Treiber, LED-Leiste und mehr werden als Board Support Package (BSP) gebündelt. Die BSP sind Treiber mit APIs, die einen vereinfachten Zugriff auf die Funktionen der Hardware bieten. Das BSP befindet sich im Ordner `core2-for-aws-iot-edukit/blink-hello-world/Components/core2foraws/`. In diesem Beispiel wurde der SK6812-Treiber zur Steuerung der seitlichen LED-Leisten verwendet, und die [LVGL-Bibliothek](https://docs.lvgl.io/v7/en/html/) wurde verwendet, um die Elemente auf dem Display anzuzeigen. Informationen zu den verfügbaren Anwendungsprogrammierschnittstellen (APIs) des BSP und deren Verwendung finden Sie in der <a href="https://edukit.workshop.aws/en/api-reference/index.html" target="_blank">Core2 for AWS IoT Kit-API-Referenz</a>.

Weiter zum nächsten Tutorial, [**Intelligentes Thermostat**](/de/smart-thermostat.html).

---
{{% button href="https://github.com/aws-samples/aws-iot-edukit-tutorials/discussions" icon="far fa-question-circle" %}}Community support{{% /button %}} {{% button href="https://github.com/m5stack/Core2-for-AWS-IoT-Kit/issues" icon="fas fa-bug" %}}Report bugs{{% /button %}}